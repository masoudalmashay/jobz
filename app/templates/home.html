{% extends "base.html" %}

{% block title %}
{% endblock %}

{% block description %}
ุงุจุญุซ ุนู ุฃูุถู ูุฑุต ุงูุนูู ูู ููุจูุง ุนูู ููุตุชูุง ุงููุฎุตุตุฉ. ููุฏู ูุธุงุฆู ูุชููุนุฉ ูู ูุฎุชูู ุงููุทุงุนุงุช ูุซู ุงูุชูููููุฌูุงุ ุงูุชุนูููุ ุงูุทุจุ ูุงูููุฏุณุฉ. ูู ุจุงูุชูุฏูู ุจุณูููุฉ ูุงุจุญุซ ุนู ุงููุธููุฉ ุงููุซุงููุฉ ูู ุงูุขู.
{% endblock %}


{% block hero %}
{% include "partials/_hero.html" %}
{%endblock%}


{% block content %}
<div class="px-2 md:px-6  pt-8 w-full md:w-[80%] md:mx-auto text-sm text-gray-500">
    ุชุตููู ุจูุงุกุง ุนูู
</div>
<form method="GET" class="w-full" id="filter-form">
    <div class="pt-2 pb-6 px-2 md:px-6 w-full md:w-[80%] md:mx-auto text-xl font-bold space-y-2 md:space-y-0 md:flex justify-between">
      <div class="flex gap-2 w-full">
        <label class="input">
          <svg class="h-[1em] opacity-50" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <g stroke-linejoin="round" stroke-linecap="round" stroke-width="2.5" fill="none" stroke="currentColor">
              <circle cx="11" cy="11" r="8"></circle>
              <path d="m21 21-4.3-4.3"></path>
            </g>
          </svg>
          <input name="search" type="search" class="grow" placeholder="ุจุญุซ" value="{{ request.args.get('search', '') }}" />
        </label>
        <button class="btn btn-neutral">ุจุญุซ</button>
      </div>
  
      <div class="flex gap-2">
        <select class="select" name="category" onchange="document.getElementById('filter-form').submit()">
          <option disabled selected>ุงูุชุตูููุงุช</option>
          <option value="">ุงููู</option>
          {% for category in categories %}
          <option value="{{ category.id }}" {% if request.args.get('category') == category.id|string %}selected{% endif %}>{{ category.name }}</option>
          {% endfor %}
        </select>
  
        <select class="select" name="city" onchange="document.getElementById('filter-form').submit()">
          <option disabled selected>ุงููุฏู</option>
          <option value="">ุงููู</option>
          {% for city in cities %}
          <option value="{{ city.id }}" {% if request.args.get('city') == city.id|string %}selected{% endif %}>{{ city.name }}</option>
          {% endfor %}
        </select>
  
        <button class="btn btn-neutral" type="submit" style="display: none;">ุจุญุซ</button> <!-- Hidden submit button -->
      </div>
    </div>
  </form>
  
<div class="p-2 md:p-6 w-full md:w-[80%] md:mx-auto space-y-4" id="records" x-merge="append">
    {% if not jobs %}
        <p class="text-center text-gray-600">ูุง ููุฌุฏ ูุธุงุฆู</p>
    {% else: %}
    
    {% for job in jobs: %}
    <div class="bg-white shadow-sm border border-gray-200 p-2 md:p-6 rounded-sm md:flex justify-between items-center">
        <div class="flex gap-4 items-center justify-center">
            <div class="avatar">
                <div class="w-16 md:w-20 rounded-full border border-gray-300">
                  <img src="{{r2_public_url}}/{{job['user']['logo_url']}}" />
                </div>
            </div>
    
            <div class="space-y-1 md:space-y-2">
                <p class="text-gray-800 font-bold md:text-lg">{{job['job'].title}}</p>
                <p class="text-gray-600">{{job['user']['company_name']}}</p>
                <div>
                    <div class="badge badge-outline badge-info">{{job['job'].category.name}}</div>
                    <div class="badge badge-outline badge-warning">{{job['job'].city.name}}</div>
                </div>
            </div>
        </div>
        <div>
            <a href="{{url_for('job_listing.single_job', job_id=job['job'].slug)}}" class="btn btn-neutral btn-sm md:btn-lg w-full mt-4 md:mt-0">๐ ุชูุฏูู</a>
        </div>
    </div>
    {% endfor %}

    <div class="mt-6 flex justify-center space-x-2" id="pagination" x-init x-intersect="$ajax('{{ url_for('main.home', page=pagination.next_num, search=current_search, category=current_category, city=current_city) }}', { target: 'records pagination' })" >
        {% if pagination.has_prev %}
          <a href="{{ url_for('main.home', page=pagination.prev_num, search=current_search, category=current_category, city=current_city) }}" class="btn btn-outline">โฌ๏ธ ุงูุณุงุจู</a>
        {% endif %}
      
        <span class="btn btn-disabled">ุตูุญุฉ {{ pagination.page }} ูู {{ pagination.pages }}</span>
      
        {% if pagination.has_next %}
          <a href="{{ url_for('main.home', page=pagination.next_num, search=current_search, category=current_category, city=current_city) }}" class="btn btn-outline">ุงูุชุงูู โก๏ธ</a>
        {% endif %}
    </div>


    {% endif %}

    
    
</div>
{% endblock %}